function isFunction(e){return e instanceof Function}function matchFunction(e){var a;switch(e){case"textComponentRender":a=textComponentRender;break;case"switchComponentRender":a=switchComponentRender;break;case"selectComponentRender":a=selectComponentRender;break;case"parameterizedComponentRender":a=parameterizedComponentRender;break;case"textParameterRender":a=textParameterRender;break;default:a=emptyComponentRender}return a}function castFunction(e){return isFunction(e)?e:matchFunction(e)}function ParseInt(e){var a=parseInt(e);return isNaN(a)?0:a}function emptyComponentRender(e,a,t,n={}){var r=$("<div></div>");r.addClass("col-md-2");var o=$("<div></div>");o.addClass("form-group "+t.prefix_class+e),o.attr("id",t.prefix_class+e);var s=$("<div>Empty component</div>");return s.attr("name",e),s.attr("id",e),o.append(s),r.append(o),a.append(r),o}function textComponentRender(e,a,t,n={}){var r=$("<div></div>");r.addClass("col-md-2");var o=$("<div></div>");o.addClass("form-group "+t.prefix_class+e),o.attr("id",t.prefix_class+e);var s=$("<label></label>");s.addClass("control-label"),s.html(t.label),s.attr("for",e),o.append(s);var d=$("<div></div>");d.addClass("input-group");var i=$("<input />");i.addClass("form-control input-xs"),i.attr("name",e),i.attr("id",e),i.attr("required",""),i.attr("placeholder",t.placeholder),i.val(t.value),state.validation.hasOwnProperty(e)&&i.addClass("validatable"),d.append(i);var l=$("<div></div>");if(l.addClass("input-group-addon"),l.attr("id",e+"_addon"),l.html(t.addOn),d.append(l),o.append(d),state.validation.hasOwnProperty(e)){i.addClass("validatable");var p=$("<div></div>");p.addClass("messages"),o.append(p)}return r.append(o),a.append(r),Object.keys(n).forEach(function(e){n.hasOwnProperty(e)&&i.bind(e,n[e])}),o}function switchComponentRender(e,a,t,n={}){var r=$("<div></div>");r.addClass("col-md-3");var o=$("<div></div>");o.addClass("form-group "+t.prefix_class+e),o.attr("id",t.prefix_class+e),o.css("width","100%"),o.html('<div style="min-height:30px;">'+t.label+"</div>");var s=$("<label></label>");s.addClass("checkbox-inline checkbox-left checkbox-switchery switchery-sm");var d=$("<input />",{type:"checkbox",id:t.prefix_id+e,value:t.value});return d.addClass("switchery-primary"),t.hasOwnProperty("checked")?d.prop("checked",!0):d.prop("checked",!1),s.append(d),s.css("margin-bottom","40px"),o.append(s),r.append(o),a.append(r),Object.keys(n).forEach(function(e){n.hasOwnProperty(e)&&d.bind(e,n[e])}),o}function selectComponentRender(e,a,t,n={}){var r=$("<div></div>");r.addClass("col-md-3");var o=$("<div></div>");o.addClass("form-group "+e),o.attr("id",t.prefix_class+e),o.css("margin-bottom","20px"),o.css("width","100%");var s=$("<label></label>");s.addClass("control-label"),s.html(t.label),o.append(s);var d=$("<select></select>");if(d.addClass("form-control select-size-xs select"),d.attr("name",e),d.attr("id",e),d.css("width","100%"),Object.keys(t.options).forEach(function(e){var a=$("<option></option>");a.val(e),a.html(t.options[e]),d.append(a)}),t.hasOwnProperty("value")){var i=t.value;t.options.hasOwnProperty(i)&&d.val(i).change()}return o.append(d),r.append(o),a.append(r),Object.keys(n).forEach(function(e){n.hasOwnProperty(e)&&d.bind(e,n[e])}),d.select2({minimumResultsForSearch:1/0,containerCssClass:"select-xs"}),o}function parameterizedComponentRender(e,a,t,n={}){var r,o=componentByName(e);if(null!=o){(r=castFunction(o.ownRender)(e,a,t,n)).parent().addClass("thin-border");var s=$("<div></div>");s.attr("id","params_"+e),s.css("margin-top","10px"),renderComponents(t.param_components[t.value],s),r.append(s);var d=$("#"+e);Object.keys(n).forEach(function(e){n.hasOwnProperty(e)&&d.bind(e,n[e])})}return r}function textParameterRender(e,a,t,n={}){var r=$("<div></div>");r.addClass("form-group "+t.prefix_class+e);var o=$("<label></label>");o.addClass("col-sm-6 text-right control-label"),o.html(t.label),o.attr("for",e),r.append(o);var s=$("<div></div>");s.addClass("input-group col-sm-6");var d=$("<input />");d.addClass("form-control input-xs"),d.attr("name",e),d.attr("id",e),d.attr("required",""),d.attr("placeholder",t.placeholder),d.val(t.value),state.validation.hasOwnProperty(e)&&d.addClass("validatable"),s.append(d);var i=$("<div></div>");if(i.addClass("input-group-addon"),i.attr("id",e+"_addon"),i.html(t.addOn),s.append(i),r.append(s),state.validation.hasOwnProperty(e)){d.addClass("validatable");var l=$("<div></div>");l.addClass("messages"),r.append(l)}a.append(r),Object.keys(n).forEach(function(e){n.hasOwnProperty(e)&&d.bind(e,n[e])})}function componentByName(e){var a=state.components.filter(a=>a.component===e);return void 0!==a[0]?a[0]:null}function setProp(e,a,t){componentByName(e).props[a]=t}function getProp(e,a){var t=componentByName(e);if(null!=t)return t.props[a]}function renderComponent(e,a){var t=componentByName(e);null!=t&&castFunction(t.handler)(e,a,t.props,t.events)}function renderComponents(e,a){Array.isArray(e)&&e.forEach(function(e){renderComponent(e,a)})}function get_nested_component(e,a,t){return a.length>t+1?get_nested_component(e[a[t]],a,t+1):e[a[t]]}function onChangeSelectDefaultHandler(){var e=$("#"+this.id+" option:selected").val();setProp(this.id,"value",e)}function onChangeSwitcherDefaultHandler(){var e=$("#"+this.id).prop("checked");setProp(this.id,"value",e?"true":"false")}function onChangeInputDefaultHandler(){if("text"==this.type&&(setProp(this.id,"value",this.value),console.log("Component "+this.id+" changed to "+this.value)),this.classList.contains("validatable")){var e=document.querySelector("#modular_system_calculator");showErrorsForInput(this,(validate(e,state.validation)||{})[this.name])}}function showErrors(e,a){Array.prototype.slice.call(e.querySelectorAll(".validatable")).forEach(function(e){showErrorsForInput(e,a&&a[e.name])})}function showErrorsForInput(e,a){var t=closestParent(e.parentNode,"form-group"),n=t.querySelector(".messages");resetFormGroup(t),a?(t.classList.add("has-error"),Array.prototype.slice.call(a).forEach(function(e){addError(n,e)})):t.classList.add("has-success")}function closestParent(e,a){return e&&e!==document?e.classList.contains(a)?e:closestParent(e.parentNode,a):null}function resetFormGroup(e){e.classList.remove("has-error"),e.classList.remove("has-success"),Array.prototype.slice.call(e.querySelectorAll(".help-block.error")).forEach(function(e){e.parentNode.removeChild(e)})}function addError(e,a){var t=document.createElement("p");t.classList.add("help-block"),t.classList.add("error"),t.innerText=a,e.appendChild(t)}
