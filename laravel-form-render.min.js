function isFunction(e){return e instanceof Function}function matchFunction(e){var a;switch(e){case"textComponentRender":a=textComponentRender;break;case"switchComponentRender":a=switchComponentRender;break;case"selectComponentRender":a=selectComponentRender;break;case"parameterizedComponentRender":a=parameterizedComponentRender;break;case"textParameterRender":a=textParameterRender;break;case"selectParameterRender":a=selectParameterRender;break;default:a=emptyComponentRender}return a}function castFunction(e){return isFunction(e)?e:matchFunction(e)}function ParseInt(e){var a=parseInt(e);return isNaN(a)?0:a}function emptyComponentRender(e,a,t,r={}){var n=$("<div></div>");n.addClass("col-md-2");var s=$("<div></div>"),o=t.hasOwnProperty("prefix_class")?t.prefix_class:"";s.addClass("form-group "+o+e),s.attr("id",o+e);var d=$("<div>Empty component</div>");return d.attr("name",e),d.attr("id",e),s.append(d),n.append(s),a.append(n),s}function textComponentRender(e,a,t,r={},n="col-md-2"){var s=$("<div></div>");s.addClass(n);var o=$("<div></div>"),d=t.hasOwnProperty("prefix_class")?t.prefix_class:"";o.addClass("form-group "+d+e),o.attr("id",d+e);var i=$("<label></label>");i.addClass("control-label"),i.html(t.label),i.attr("for",e),o.append(i);var l=$("<div></div>");l.addClass("input-group");var p=$("<input />");p.addClass("form-control input-xs"),p.attr("name",e),p.attr("id",e),p.attr("required",""),p.attr("placeholder",t.placeholder),p.val(t.value),state.validation.hasOwnProperty(e)&&p.addClass("validatable"),l.append(p);var c=$("<div></div>");if(c.addClass("input-group-addon"),c.attr("id",e+"_addon"),c.html(t.addOn),l.append(c),o.append(l),state.validation.hasOwnProperty(e)){p.addClass("validatable");var u=$("<div></div>");u.addClass("messages"),o.append(u)}return s.append(o),a.append(s),Object.keys(r).forEach(function(e){r.hasOwnProperty(e)&&p.bind(e,r[e])}),o}function switchComponentRender(e,a,t,r={},n="col-md-3"){var s=$("<div></div>");s.addClass(n);var o=$("<div></div>"),d=t.hasOwnProperty("prefix_class")?t.prefix_class:"";o.addClass("form-group "+d+e),o.attr("id",d+e),o.css("width","100%"),o.html('<div style="min-height:30px;">'+t.label+"</div>");var i=$("<label></label>");i.addClass("checkbox-inline checkbox-left checkbox-switchery switchery-sm");var l=$("<input />",{type:"checkbox",id:t.prefix_id+e,value:t.value});return l.addClass("switchery-primary"),t.hasOwnProperty("checked")&&1==t.checked?l.prop("checked",!0):l.prop("checked",!1),i.append(l),i.css("margin-bottom","40px"),o.append(i),s.append(o),a.append(s),Object.keys(r).forEach(function(e){r.hasOwnProperty(e)&&l.bind(e,r[e])}),o}function selectComponentRender(e,a,t,r={},n="col-md-3"){var s=$("<div></div>");s.addClass(n);var o=$("<div></div>");o.addClass("form-group "+e);var d=t.hasOwnProperty("prefix_class")?t.prefix_class:"";o.attr("id",d+e),o.css("margin-bottom","40px"),o.css("width","100%");var i=$("<label></label>");i.addClass("control-label"),i.html(t.label),o.append(i);var l=$("<div></div>");l.addClass("input-group");var p=$("<select></select>");if(p.addClass("form-control select-size-xs select"),p.attr("name",e),p.attr("id",e),p.css("width","100%"),t.hasOwnProperty("attributed_options")){if(Object.keys(t.attributed_options).forEach(function(e){var a=$("<option></option>");a.val(e),a.html(t.attributed_options[e].html),Object.keys(t.attributed_options[e].attrs).forEach(function(r){a.attr(r,t.attributed_options[e].attrs[r])}),p.append(a)}),t.hasOwnProperty("value")){var c=t.value;t.attributed_options.hasOwnProperty(c)&&p.val(c).change()}}else if(Object.keys(t.options).sort(function(e,a){var t=0,r=0;return""!=e&&NaN!=parseInt(e)&&(t=parseInt(e)),""!=a&&NaN!=parseInt(a)&&(r=parseInt(a)),t-r}).forEach(function(e){var a=$("<option></option>");a.val(e),a.html(t.options[e]),p.append(a)}),t.hasOwnProperty("value")){c=t.value;t.options.hasOwnProperty(c)&&p.val(c).change()}if(l.append(p),t.hasOwnProperty("addOn")){var u=$("<div></div>");u.addClass("input-group-addon"),u.attr("id",e+"_addon"),u.html(t.addOn),l.append(u)}return o.append(l),s.append(o),a.append(s),Object.keys(r).forEach(function(e){r.hasOwnProperty(e)&&p.bind(e,r[e])}),t.hasOwnProperty("minimumResultsForSearch")&&p.select2({minimumResultsForSearch:t.minimumResultsForSearch}),p.select2({minimumResultsForSearch:1/0,containerCssClass:"select-xs"}),o}function selectParameterRender(e,a,t,r={},n=""){var s=$("<div></div>");s.addClass(n);var o=$("<div></div>");o.addClass("form-group "+e);var d=t.hasOwnProperty("prefix_class")?t.prefix_class:"";o.attr("id",d+e),o.css("margin-bottom","40px"),o.css("width","100%");var i=$("<label></label>");i.addClass("control-label"),i.html(t.label),o.append(i);var l=$("<select></select>");if(l.addClass("form-control select-size-xs select"),l.attr("name",e),l.attr("id",e),l.css("width","100%"),Object.keys(t.options).forEach(function(e){var a=$("<option></option>");a.val(e),a.html(t.options[e]),l.append(a)}),t.hasOwnProperty("value")){var p=t.value;t.options.hasOwnProperty(p)&&l.val(p).change()}return o.append(l),s.append(o),a.append(s),Object.keys(r).forEach(function(e){r.hasOwnProperty(e)&&l.bind(e,r[e])}),l.select2({minimumResultsForSearch:1/0,containerCssClass:"select-xs"}),o}function parameterizedComponentRender(e,a,t,r={},n=""){var s,o=componentByName(e);if(null!=o){(s=castFunction(o.ownRender)(e,a,t,r)).parent().addClass("thin-border");var d=$("<div></div>");d.attr("id","params_"+e),d.css("margin-top","10px"),renderComponents(t.param_components[t.value],d),s.append(d);var i=$("#"+e);Object.keys(r).forEach(function(e){r.hasOwnProperty(e)&&i.bind(e,r[e])})}return s}function textParameterRender(e,a,t,r={},n=""){var s=$("<div></div>"),o=t.hasOwnProperty("prefix_class")?t.prefix_class:"";s.addClass("form-group "+o+e);var d=$("<label></label>");d.addClass("col-sm-6 text-right control-label"),d.html(t.label),d.attr("for",e),s.append(d);var i=$("<div></div>");i.addClass("input-group col-sm-6");var l=$("<input />");l.addClass("form-control input-xs"),l.attr("name",e),l.attr("id",e),l.attr("required",""),l.attr("placeholder",t.placeholder),l.val(t.value),state.validation.hasOwnProperty(e)&&l.addClass("validatable"),i.append(l);var p=$("<div></div>");if(p.addClass("input-group-addon"),p.attr("id",e+"_addon"),p.html(t.addOn),i.append(p),s.append(i),state.validation.hasOwnProperty(e)){l.addClass("validatable");var c=$("<div></div>");c.addClass("messages"),s.append(c)}a.append(s),Object.keys(r).forEach(function(e){r.hasOwnProperty(e)&&l.bind(e,r[e])})}function componentByName(e){var a=state.components.filter(a=>a.component===e);return void 0!==a[0]?a[0]:null}function setProp(e,a,t){var r=componentByName(e);null!=r&&(r.props[a]=t)}function getProp(e,a){var t=componentByName(e);if(null!=t)return t.props[a]}function renderComponent(e,a){var t=componentByName(e);null!=t&&castFunction(t.handler)(e,a,t.props,t.events)}function renderComponents(e,a){Array.isArray(e)&&e.forEach(function(e){renderComponent(e,a)})}function get_nested_component(e,a,t){return a.length>t+1?get_nested_component(e[a[t]],a,t+1):e[a[t]]}function onChangeSelectDefaultHandler(){var e=$("#"+this.id+" option:selected").val();setProp(this.id,"value",e)}function onChangeSwitcherDefaultHandler(){var e=$("#"+this.id).prop("checked");setProp(this.id,"value",e?"true":"false")}function onChangeInputDefaultHandler(){if("text"==this.type&&setProp(this.id,"value",this.value),this.classList.contains("validatable")){var e=document.querySelector("#modular_system_calculator");showErrorsForInput(this,(validate(e,state.validation)||{})[this.name])}}function showErrors(e,a){Array.prototype.slice.call(e.querySelectorAll(".validatable")).forEach(function(e){showErrorsForInput(e,a&&a[e.name])})}function showErrorsForInput(e,a){var t=closestParent(e.parentNode,"form-group"),r=t.querySelector(".messages");resetFormGroup(t),a?(t.classList.add("has-error"),Array.prototype.slice.call(a).forEach(function(e){addError(r,e)})):t.classList.add("has-success")}function closestParent(e,a){return e&&e!==document?e.classList.contains(a)?e:closestParent(e.parentNode,a):null}function resetFormGroup(e){e.classList.remove("has-error"),e.classList.remove("has-success"),Array.prototype.slice.call(e.querySelectorAll(".help-block.error")).forEach(function(e){e.parentNode.removeChild(e)})}function addError(e,a){var t=document.createElement("p");t.classList.add("help-block"),t.classList.add("error"),t.innerText=a,e.appendChild(t)}